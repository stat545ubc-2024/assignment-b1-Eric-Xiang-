---
title: "Assignment B1"
author: "Eric Xiang"
date: "2024-10-24"
output: github_document
---
```{r}
#import 
library(palmerpenguins)# use penguin dataset to test the function 
library(dplyr)
library(tidyverse)
library(testthat)
library(usethis)
library(devtools)#for marking down the function 
```


```{r}
summarize_data<- function(data,...,summ_vars,na.rm=FALSE){
    
  if (!is.numeric(data[[deparse(substitute(summ_vars))]])) {
    stop("Input summ_var is not in the data set or is not a numeric variable, double check")
  }
#extra variable is used in grouping if needed
  data%>%
    group_by(...)%>% 
    summarize(median=median({{summ_vars}},na.rm=na.rm),mean=mean({{summ_vars}},na.rm=na.rm),sd=sd({{summ_vars}},na.rm=na.rm)) 
    }


```

```{r}
#Exercise 2 documentation with Roxygen 
#Roxygen: list(markdown = TRUE)
```
```{r,error=TRUE}
#exercise include examples 

#working example. We utilize the penguin data to provide example. This is to show the functional example. The function first groups the data by species and island. Then, it summarizes the bill_length_mm in term of mdian, mean and sd for each group. 
summarize_data(penguins,species,island,summ_vars=bill_length_mm
,na.rm=TRUE)

#failed to show the result because the summ_vars supplied is not a numeric variable 

summarize_data(penguins,species,island,summ_vars=sex
,na.rm=TRUE)



```
```{r}
summarize_data(penguins,island,summ_vars=bill_length_mm
,na.rm=FALSE)
```


```{r}
#test to confirm a summary tibble is generated
test_that("A table is generated as the ouput", 
          {expect_gt(length(summarize_data(penguins,species,summ_vars=bill_length_mm
,na.rm=TRUE)),0)
          expect_gt(nrow(summarize_data(penguins,species,summ_vars=bill_length_mm,
na.rm=FALSE)),0)
  })

#run into error because providing non_numeric variable or providing a group_by variable not existed in the data 
test_that("run into error with non_numeric summ_var",
 {expect_error(summarize_data(penguins,island,summ_vars=sex
,na.rm=TRUE))
  expect_error(summarize_data(penguins,languages,summ_vars=sex
,na.rm=TRUE))
})

```

